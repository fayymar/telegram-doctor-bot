from aiogram import Router, F
from aiogram.types import Message, CallbackQuery
from aiogram.fsm.context import FSMContext

from bot.states import FindSpecialist
from bot.keyboards import get_specialist_categories, get_specialists_in_category


router = Router()


# –î–∞–Ω–Ω—ã–µ –æ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞—Ö
SPECIALISTS_DATA = {
    "–ö–∞—Ä–¥–∏–æ–ª–æ–≥": {
        "description": "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è–º —Å–µ—Ä–¥—Ü–∞ –∏ —Å–æ—Å—É–¥–æ–≤",
        "symptoms": "–±–æ–ª–∏ –≤ –≥—Ä—É–¥–∏, –æ–¥—ã—à–∫–∞, –Ω–∞—Ä—É—à–µ–Ω–∏—è —Ä–∏—Ç–º–∞ —Å–µ—Ä–¥—Ü–∞, –ø–æ–≤—ã—à–µ–Ω–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ"
    },
    "–ù–µ–≤—Ä–æ–ª–æ–≥": {
        "description": "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è–º –Ω–µ—Ä–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã",
        "symptoms": "–≥–æ–ª–æ–≤–Ω—ã–µ –±–æ–ª–∏, –≥–æ–ª–æ–≤–æ–∫—Ä—É–∂–µ–Ω–∏—è, –æ–Ω–µ–º–µ–Ω–∏–µ –∫–æ–Ω–µ—á–Ω–æ—Å—Ç–µ–π, —Å—É–¥–æ—Ä–æ–≥–∏"
    },
    "–ì–∞—Å—Ç—Ä–æ—ç–Ω—Ç–µ—Ä–æ–ª–æ–≥": {
        "description": "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è–º –ñ–ö–¢",
        "symptoms": "–±–æ–ª–∏ –≤ –∂–∏–≤–æ—Ç–µ, –∏–∑–∂–æ–≥–∞, —Ç–æ—à–Ω–æ—Ç–∞, –ø—Ä–æ–±–ª–µ–º—ã —Å–æ —Å—Ç—É–ª–æ–º"
    },
    "–≠–Ω–¥–æ–∫—Ä–∏–Ω–æ–ª–æ–≥": {
        "description": "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –≥–æ—Ä–º–æ–Ω–∞–ª—å–Ω—ã–º –Ω–∞—Ä—É—à–µ–Ω–∏—è–º",
        "symptoms": "–Ω–∞—Ä—É—à–µ–Ω–∏—è –≤–µ—Å–∞, –∂–∞–∂–¥–∞, —É—Ç–æ–º–ª—è–µ–º–æ—Å—Ç—å, –ø—Ä–æ–±–ª–µ–º—ã —Å —â–∏—Ç–æ–≤–∏–¥–∫–æ–π"
    },
    "–ü—É–ª—å–º–æ–Ω–æ–ª–æ–≥": {
        "description": "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è–º –¥—ã—Ö–∞—Ç–µ–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã",
        "symptoms": "–∫–∞—à–µ–ª—å, –æ–¥—ã—à–∫–∞, —Ö—Ä–∏–ø—ã, –±–æ–ª–∏ –ø—Ä–∏ –¥—ã—Ö–∞–Ω–∏–∏"
    },
    "–£—Ä–æ–ª–æ–≥": {
        "description": "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è–º –º–æ—á–µ–ø–æ–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã (–º—É–∂—á–∏–Ω—ã)",
        "symptoms": "–±–æ–ª–∏ –ø—Ä–∏ –º–æ—á–µ–∏—Å–ø—É—Å–∫–∞–Ω–∏–∏, –ø—Ä–æ–±–ª–µ–º—ã —Å –ø–æ—á–∫–∞–º–∏, –ø–æ–ª–æ–≤—ã–µ –¥–∏—Å—Ñ—É–Ω–∫—Ü–∏–∏"
    },
    "–ì–∏–Ω–µ–∫–æ–ª–æ–≥": {
        "description": "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∂–µ–Ω—Å–∫–æ–º—É –∑–¥–æ—Ä–æ–≤—å—é",
        "symptoms": "–Ω–∞—Ä—É—à–µ–Ω–∏—è —Ü–∏–∫–ª–∞, –±–æ–ª–∏ –≤–Ω–∏–∑—É –∂–∏–≤–æ—Ç–∞, –≤—ã–¥–µ–ª–µ–Ω–∏—è"
    },
    "–î–µ—Ä–º–∞—Ç–æ–ª–æ–≥": {
        "description": "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è–º –∫–æ–∂–∏",
        "symptoms": "—Å—ã–ø—å, –∑—É–¥, –ø—è—Ç–Ω–∞, –ø—Ä–æ–±–ª–µ–º—ã —Å –≤–æ–ª–æ—Å–∞–º–∏ –∏ –Ω–æ–≥—Ç—è–º–∏"
    },
    "–û—Ñ—Ç–∞–ª—å–º–æ–ª–æ–≥": {
        "description": "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è–º –≥–ª–∞–∑",
        "symptoms": "—Å–Ω–∏–∂–µ–Ω–∏–µ –∑—Ä–µ–Ω–∏—è, –±–æ–ª–∏ –≤ –≥–ª–∞–∑–∞—Ö, –ø–æ–∫—Ä–∞—Å–Ω–µ–Ω–∏–µ, —Å–ª–µ–∑–æ—Ç–µ—á–µ–Ω–∏–µ"
    },
    "–û—Ç–æ–ª–∞—Ä–∏–Ω–≥–æ–ª–æ–≥ (–õ–û–†)": {
        "description": "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è–º —É—Ö–∞, –≥–æ—Ä–ª–∞ –∏ –Ω–æ—Å–∞",
        "symptoms": "–±–æ–ª—å –≤ –≥–æ—Ä–ª–µ, –∑–∞–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å –Ω–æ—Å–∞, –±–æ–ª–∏ –≤ —É—à–∞—Ö, –Ω–∞—Å–º–æ—Ä–∫"
    },
    "–û—Ä—Ç–æ–ø–µ–¥-—Ç—Ä–∞–≤–º–∞—Ç–æ–ª–æ–≥": {
        "description": "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è–º –∫–æ—Å—Ç–µ–π –∏ —Å—É—Å—Ç–∞–≤–æ–≤",
        "symptoms": "–±–æ–ª–∏ –≤ —Å—É—Å—Ç–∞–≤–∞—Ö, —Ç—Ä–∞–≤–º—ã, –ø—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–∑–≤–æ–Ω–æ—á–Ω–∏–∫–æ–º"
    },
    "–†–µ–≤–º–∞—Ç–æ–ª–æ–≥": {
        "description": "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∞—É—Ç–æ–∏–º–º—É–Ω–Ω—ã–º –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è–º —Å—É—Å—Ç–∞–≤–æ–≤",
        "symptoms": "–±–æ–ª–∏ –≤ —Å—É—Å—Ç–∞–≤–∞—Ö, —Å–∫–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –ø–æ —É—Ç—Ä–∞–º, –æ—Ç–µ–∫–∏ —Å—É—Å—Ç–∞–≤–æ–≤"
    },
    "–ê–ª–ª–µ—Ä–≥–æ–ª–æ–≥-–∏–º–º—É–Ω–æ–ª–æ–≥": {
        "description": "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∞–ª–ª–µ—Ä–≥–∏—è–º –∏ –∏–º–º—É–Ω–Ω—ã–º –Ω–∞—Ä—É—à–µ–Ω–∏—è–º",
        "symptoms": "–∞–ª–ª–µ—Ä–≥–∏—á–µ—Å–∫–∏–µ —Ä–µ–∞–∫—Ü–∏–∏, —á–∞—Å—Ç—ã–µ –ø—Ä–æ—Å—Ç—É–¥—ã, –Ω–µ–ø–µ—Ä–µ–Ω–æ—Å–∏–º–æ—Å—Ç—å –ø—Ä–æ–¥—É–∫—Ç–æ–≤"
    },
    "–ü—Å–∏—Ö–∏–∞—Ç—Ä": {
        "description": "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –ø—Å–∏—Ö–∏—á–µ—Å–∫–∏–º —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º",
        "symptoms": "–¥–µ–ø—Ä–µ—Å—Å–∏—è, —Ç—Ä–µ–≤–æ–≥–∞, –Ω–∞—Ä—É—à–µ–Ω–∏—è —Å–Ω–∞, –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è"
    },
    "–û–Ω–∫–æ–ª–æ–≥": {
        "description": "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –æ–Ω–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–º –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è–º",
        "symptoms": "–Ω–æ–≤–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è, –Ω–µ–æ–±—ä—è—Å–Ω–∏–º–∞—è –ø–æ—Ç–µ—Ä—è –≤–µ—Å–∞, –¥–ª–∏—Ç–µ–ª—å–Ω—ã–µ —Å–∏–º–ø—Ç–æ–º—ã"
    },
    "–•–∏—Ä—É—Ä–≥": {
        "description": "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–∏–º –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞–º",
        "symptoms": "–æ—Å—Ç—Ä—ã–µ –±–æ–ª–∏ –≤ –∂–∏–≤–æ—Ç–µ, —Ç—Ä–∞–≤–º—ã, –Ω–æ–≤–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Ç—Ä–µ–±—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏"
    },
    "–ü—Ä–æ–∫—Ç–æ–ª–æ–≥": {
        "description": "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è–º –ø—Ä—è–º–æ–π –∫–∏—à–∫–∏",
        "symptoms": "–±–æ–ª–∏ –ø—Ä–∏ –¥–µ—Ñ–µ–∫–∞—Ü–∏–∏, –∫—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏—è, –≥–µ–º–æ—Ä—Ä–æ–π"
    },
    "–ú–∞–º–º–æ–ª–æ–≥": {
        "description": "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è–º –º–æ–ª–æ—á–Ω—ã—Ö –∂–µ–ª–µ–∑",
        "symptoms": "–±–æ–ª–∏ –≤ –≥—Ä—É–¥–∏, —É–ø–ª–æ—Ç–Ω–µ–Ω–∏—è, –≤—ã–¥–µ–ª–µ–Ω–∏—è –∏–∑ —Å–æ—Å–∫–æ–≤"
    },
    "–ù–µ—Ñ—Ä–æ–ª–æ–≥": {
        "description": "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è–º –ø–æ—á–µ–∫",
        "symptoms": "–±–æ–ª–∏ –≤ –ø–æ—è—Å–Ω–∏—Ü–µ, –æ—Ç–µ–∫–∏, –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∞–Ω–∞–ª–∏–∑–∞—Ö –º–æ—á–∏"
    },
    "–§–ª–µ–±–æ–ª–æ–≥": {
        "description": "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è–º –≤–µ–Ω",
        "symptoms": "–≤–∞—Ä–∏–∫–æ–∑, –æ—Ç–µ–∫–∏ –Ω–æ–≥, –±–æ–ª–∏ –≤ –≤–µ–Ω–∞—Ö"
    },
    "–°–æ—Å—É–¥–∏—Å—Ç—ã–π —Ö–∏—Ä—É—Ä–≥": {
        "description": "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ —Å–æ—Å—É–¥–∏—Å—Ç—ã–º –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è–º",
        "symptoms": "–±–æ–ª–∏ –≤ –Ω–æ–≥–∞—Ö –ø—Ä–∏ —Ö–æ–¥—å–±–µ, —Ö–æ–ª–æ–¥–Ω—ã–µ –∫–æ–Ω–µ—á–Ω–æ—Å—Ç–∏, —è–∑–≤—ã"
    },
    "–ù–µ–π—Ä–æ—Ö–∏—Ä—É—Ä–≥": {
        "description": "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ —Ö–∏—Ä—É—Ä–≥–∏–∏ –Ω–µ—Ä–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã",
        "symptoms": "–≥—Ä—ã–∂–∏ –ø–æ–∑–≤–æ–Ω–æ—á–Ω–∏–∫–∞, –æ–ø—É—Ö–æ–ª–∏ –º–æ–∑–≥–∞, —Å–µ—Ä—å–µ–∑–Ω—ã–µ —Ç—Ä–∞–≤–º—ã"
    },
    "–ì–µ–ø–∞—Ç–æ–ª–æ–≥": {
        "description": "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è–º –ø–µ—á–µ–Ω–∏",
        "symptoms": "–∂–µ–ª—Ç—É—Ö–∞, –±–æ–ª–∏ –≤ –ø—Ä–∞–≤–æ–º –ø–æ–¥—Ä–µ–±–µ—Ä—å–µ, –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∞–Ω–∞–ª–∏–∑–∞—Ö"
    },
    "–î–∏–∞–±–µ—Ç–æ–ª–æ–≥": {
        "description": "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –¥–∏–∞–±–µ—Ç—É",
        "symptoms": "–ø–æ–≤—ã—à–µ–Ω–Ω—ã–π —Å–∞—Ö–∞—Ä, –∂–∞–∂–¥–∞, —á–∞—Å—Ç–æ–µ –º–æ—á–µ–∏—Å–ø—É—Å–∫–∞–Ω–∏–µ"
    },
    "–§—Ç–∏–∑–∏–∞—Ç—Ä": {
        "description": "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ —Ç—É–±–µ—Ä–∫—É–ª–µ–∑—É",
        "symptoms": "–¥–ª–∏—Ç–µ–ª—å–Ω—ã–π –∫–∞—à–µ–ª—å, –Ω–æ—á–Ω–∞—è –ø–æ—Ç–ª–∏–≤–æ—Å—Ç—å, –ø–æ—Ç–µ—Ä—è –≤–µ—Å–∞"
    },
    "–ú–∞–Ω—É–∞–ª—å–Ω—ã–π —Ç–µ—Ä–∞–ø–µ–≤—Ç": {
        "description": "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –º–∞–Ω—É–∞–ª—å–Ω–æ–π —Ç–µ—Ä–∞–ø–∏–∏ –ø–æ–∑–≤–æ–Ω–æ—á–Ω–∏–∫–∞",
        "symptoms": "–±–æ–ª–∏ –≤ —Å–ø–∏–Ω–µ, —Å–∫–æ–≤–∞–Ω–Ω–æ—Å—Ç—å, –º—ã—à–µ—á–Ω—ã–µ –∑–∞–∂–∏–º—ã"
    },
    "–°—É—Ä–¥–æ–ª–æ–≥": {
        "description": "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –Ω–∞—Ä—É—à–µ–Ω–∏—è–º —Å–ª—É—Ö–∞",
        "symptoms": "—Å–Ω–∏–∂–µ–Ω–∏–µ —Å–ª—É—Ö–∞, —à—É–º –≤ —É—à–∞—Ö, –≥–æ–ª–æ–≤–æ–∫—Ä—É–∂–µ–Ω–∏—è"
    },
    "–¢—Ä–∏—Ö–æ–ª–æ–≥": {
        "description": "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è–º –≤–æ–ª–æ—Å –∏ –∫–æ–∂–∏ –≥–æ–ª–æ–≤—ã",
        "symptoms": "–≤—ã–ø–∞–¥–µ–Ω–∏–µ –≤–æ–ª–æ—Å, –ø–µ—Ä—Ö–æ—Ç—å, –∑—É–¥ –∫–æ–∂–∏ –≥–æ–ª–æ–≤—ã"
    },
    "–ê–Ω–¥—Ä–æ–ª–æ–≥": {
        "description": "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –º—É–∂—Å–∫–æ–º—É –∑–¥–æ—Ä–æ–≤—å—é",
        "symptoms": "–ø–æ–ª–æ–≤—ã–µ –¥–∏—Å—Ñ—É–Ω–∫—Ü–∏–∏, –±–µ—Å–ø–ª–æ–¥–∏–µ, –≥–æ—Ä–º–æ–Ω–∞–ª—å–Ω—ã–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è"
    },
    "–ò–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–∏—Å—Ç": {
        "description": "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω—ã–º –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è–º",
        "symptoms": "–≤—ã—Å–æ–∫–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, –ø—Ä–∏–∑–Ω–∞–∫–∏ –∏–Ω—Ñ–µ–∫—Ü–∏–∏, –∫–æ–Ω—Ç–∞–∫—Ç —Å –±–æ–ª—å–Ω—ã–º–∏"
    },
    "–¢–µ—Ä–∞–ø–µ–≤—Ç": {
        "description": "–í—Ä–∞—á –æ–±—â–µ–π –ø—Ä–∞–∫—Ç–∏–∫–∏",
        "symptoms": "–ª—é–±—ã–µ –∂–∞–ª–æ–±—ã –Ω–∞ –∑–¥–æ—Ä–æ–≤—å–µ –¥–ª—è –ø–µ—Ä–≤–∏—á–Ω–æ–≥–æ –æ—Å–º–æ—Ç—Ä–∞"
    }
}


# ============ –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ –°–ü–ï–¶–ò–ê–õ–ò–°–¢–û–í ============

@router.message(F.text == "üîç –ù–∞–π—Ç–∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞")
async def show_specialist_categories(message: Message, state: FSMContext):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤"""
    await state.clear()  # –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
    
    await message.answer(
        "üîç *–ù–∞–π—Ç–∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞*\n\n"
        "–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:",
        reply_markup=get_specialist_categories(),
        parse_mode="Markdown"
    )
    await state.set_state(FindSpecialist.choosing_category)


# ============ –í–´–ë–û–† –ö–ê–¢–ï–ì–û–†–ò–ò ============

@router.callback_query(FindSpecialist.choosing_category, F.data.startswith("cat_"))
async def show_specialists_in_category(callback: CallbackQuery, state: FSMContext):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤ –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"""
    category = callback.data.split("_")[1]
    
    category_names = {
        "cardio": "‚ù§Ô∏è –°–µ—Ä–¥—Ü–µ –∏ —Å–æ—Å—É–¥—ã",
        "neuro": "üß† –ù–µ—Ä–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞",
        "gastro": "üçΩ –ü–∏—â–µ–≤–∞—Ä–µ–Ω–∏–µ",
        "endo": "üíä –ì–æ—Ä–º–æ–Ω—ã –∏ –æ–±–º–µ–Ω –≤–µ—â–µ—Å—Ç–≤",
        "pulmo": "ü´Å –î—ã—Ö–∞—Ç–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞",
        "ortho": "ü¶¥ –û–ø–æ—Ä–Ω–æ-–¥–≤–∏–≥–∞—Ç–µ–ª—å–Ω—ã–π –∞–ø–ø–∞—Ä–∞—Ç",
        "sense": "üëÅ –ó—Ä–µ–Ω–∏–µ –∏ —Å–ª—É—Ö",
        "derm": "üß¨ –ö–æ–∂–∞ –∏ –∞–ª–ª–µ—Ä–≥–∏—è",
        "repro": "üë∂ –ñ–µ–Ω—Å–∫–æ–µ –∏ –º—É–∂—Å–∫–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ",
        "other": "ü©∫ –î—Ä—É–≥–∏–µ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—ã"
    }
    
    await state.update_data(current_category=category)
    
    await callback.message.edit_text(
        f"*{category_names.get(category, '–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—ã')}*\n\n"
        "–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞ –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏:",
        reply_markup=get_specialists_in_category(category),
        parse_mode="Markdown"
    )
    await state.set_state(FindSpecialist.viewing_specialists)
    await callback.answer()


# ============ –ü–†–û–°–ú–û–¢–† –ò–ù–§–û–†–ú–ê–¶–ò–ò –û –°–ü–ï–¶–ò–ê–õ–ò–°–¢–ï ============

@router.callback_query(FindSpecialist.viewing_specialists, F.data.startswith("spec_"))
async def show_specialist_info(callback: CallbackQuery, state: FSMContext):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–µ"""
    specialist_name = callback.data.replace("spec_", "")
    
    specialist_info = SPECIALISTS_DATA.get(specialist_name, {
        "description": "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞",
        "symptoms": "‚Äî"
    })
    
    info_text = f"ü©∫ *{specialist_name}*\n\n"
    info_text += f"üìã {specialist_info['description']}\n\n"
    info_text += f"üîç *–û—Å–Ω–æ–≤–Ω—ã–µ —Å–∏–º–ø—Ç–æ–º—ã:*\n{specialist_info['symptoms']}\n\n"
    info_text += "üí° *–ö–∞–∫ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è:*\n"
    info_text += "–§—É–Ω–∫—Ü–∏—è –∑–∞–ø–∏—Å–∏ –∫ –≤—Ä–∞—á—É –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ.\n"
    info_text += "–ü–æ–∫–∞ –≤—ã –º–æ–∂–µ—Ç–µ –Ω–∞—á–∞—Ç—å –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏."
    
    # –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π
    from aiogram.types import InlineKeyboardMarkup, InlineKeyboardButton
    
    keyboard = InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="ü©∫ –ù–∞—á–∞—Ç—å –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é", callback_data="start_consultation_specialist")],
        [InlineKeyboardButton(text="üîô –ö —Å–ø–∏—Å–∫—É —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤", callback_data="back_to_specialists")]
    ])
    
    await callback.message.edit_text(
        info_text,
        reply_markup=keyboard,
        parse_mode="Markdown"
    )
    await callback.answer()


@router.callback_query(F.data == "start_consultation_specialist")
async def start_consultation_from_specialist(callback: CallbackQuery, state: FSMContext):
    """–ù–∞—á–∏–Ω–∞–µ—Ç –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤"""
    from bot.handlers.consultation import start_consultation
    
    await callback.message.delete()
    await state.clear()
    
    # –ò–º–∏—Ç–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏
    fake_message = callback.message
    fake_message.text = "ü©∫ –ù–æ–≤–∞—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è"
    
    await start_consultation(fake_message, state)
    await callback.answer()


# ============ –ù–ê–í–ò–ì–ê–¶–ò–Ø ============

@router.callback_query(F.data == "back_to_specialists")
async def back_to_specialists_list(callback: CallbackQuery, state: FSMContext):
    """–í–æ–∑–≤—Ä–∞—Ç –∫ —Å–ø–∏—Å–∫—É —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"""
    data = await state.get_data()
    category = data.get('current_category', 'cardio')
    
    category_names = {
        "cardio": "‚ù§Ô∏è –°–µ—Ä–¥—Ü–µ –∏ —Å–æ—Å—É–¥—ã",
        "neuro": "üß† –ù–µ—Ä–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞",
        "gastro": "üçΩ –ü–∏—â–µ–≤–∞—Ä–µ–Ω–∏–µ",
        "endo": "üíä –ì–æ—Ä–º–æ–Ω—ã –∏ –æ–±–º–µ–Ω –≤–µ—â–µ—Å—Ç–≤",
        "pulmo": "ü´Å –î—ã—Ö–∞—Ç–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞",
        "ortho": "ü¶¥ –û–ø–æ—Ä–Ω–æ-–¥–≤–∏–≥–∞—Ç–µ–ª—å–Ω—ã–π –∞–ø–ø–∞—Ä–∞—Ç",
        "sense": "üëÅ –ó—Ä–µ–Ω–∏–µ –∏ —Å–ª—É—Ö",
        "derm": "üß¨ –ö–æ–∂–∞ –∏ –∞–ª–ª–µ—Ä–≥–∏—è",
        "repro": "üë∂ –ñ–µ–Ω—Å–∫–æ–µ –∏ –º—É–∂—Å–∫–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ",
        "other": "ü©∫ –î—Ä—É–≥–∏–µ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—ã"
    }
    
    await callback.message.edit_text(
        f"*{category_names.get(category, '–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—ã')}*\n\n"
        "–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞ –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏:",
        reply_markup=get_specialists_in_category(category),
        parse_mode="Markdown"
    )
    await state.set_state(FindSpecialist.viewing_specialists)
    await callback.answer()


@router.callback_query(F.data == "back_to_categories")
async def back_to_categories(callback: CallbackQuery, state: FSMContext):
    """–í–æ–∑–≤—Ä–∞—Ç –∫ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤"""
    await callback.message.edit_text(
        "üîç *–ù–∞–π—Ç–∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞*\n\n"
        "–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:",
        reply_markup=get_specialist_categories(),
        parse_mode="Markdown"
    )
    await state.set_state(FindSpecialist.choosing_category)
    await callback.answer()
